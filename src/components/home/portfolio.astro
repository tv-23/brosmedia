---
const portfolio = [
    {
        img: "/our-references/inadworld.com.webp",
        tag: "website",
        badge: "Conception de site web",
        title: "Inad World",
        url: "https://inadworld.com",
    },
    {
        img: "/our-references/moulaybousselhamimmobilier.com.webp",
        tag: "website",
        badge: "Conception de site web",
        title: "MoulayBousselham Immobilier",
        url: "https://moulaybousselhamimmobilier.com",
    },
    {
        img: "/our-references/drhachimiyassmine.com.webp",
        tag: "website",
        badge: "Conception de site web",
        title: "DR HACHIMI yassmine",
        url: "https://drhachimiyassmine.com/",
    },
     {
        img: "/our-references/esunivers.com.webp",
        tag: "website",
        badge: "Conception de site web",
        title: "Esunivers",
        url: "https://esunivers.com",
    },
    {
        img: "/our-references/probyu.com.webp",
        tag: "website",
        badge: "Conception de site web",
        title: "Probyu",
        url: "https://probyu.com/",
    },
    {
        img: "/our-references/wefruits.ma.webp",
        tag: "website",
        badge: "Conception de site web",
        title: "WeFruits",
        url: "https://wefruits.ma",
    },
    {
        img: "/our-references/imagaleries.com.webp",
        tag: "website",
        badge: "Conception de site web",
        title: "IMA Galeries",
        url: "https://imagaleries.com/",
    },
    {
        img: "/our-references/wecargo.ma.webp",
        tag: "website",
        badge: "Conception de site web",
        title: "WeCargo",
        url: "https://wecargo.ma",
    },
    {
        img: "/our-references/uk-cafe.ma.webp",
        tag: "website",
        badge: "Conception de site web",
        title: "UK cafe",
        url: "https://uk-cafe.ma",
    },
    {
        img: "/our-references/mye-fruits.com.webp",
        tag: "website",
        badge: "Conception de site web",
        title: "Mye Fruits",
        url: "https://mye-fruits.com",
    },
    {
        img: "/our-references/maison-dart.com.webp",
        tag: "website",
        badge: "Conception de site web",
        title: "Maison Dart",
        url: "https://maison-dart.com",
    },
    {
        img: "/our-references/location-elite.com.webp",
        tag: "website",
        badge: "Conception de site web",
        title: "Location Elite",
        url: "https://location-elite.com",
    },
    {
        img: "/our-references/hygienegos.com.webp",
        tag: "website",
        badge: "Conception de site web",
        title: "Hygienegos",
        url: "https://hygienegos.com",
    },
    {
        img: "/our-references/hipeca-exp.com.webp",
        tag: "website",
        badge: "Conception de site web",
        title: "Hipeca Export",
        url: "https://hipeca-exp.com",
    },
    {
        img: "/our-references/granderberry.com.webp",
        tag: "website",
        badge: "Conception de site web",
        title: "GranderBerry",
        url: "https://granderberry.com",
    },
    {
        img: "/our-references/epowermotorsmaroc.com.webp",
        tag: "website",
        badge: "Conception de site web",
        title: "Epower Motors",
        url: "https://epowermotorsmaroc.com",
    },

     {
        img: "/our-references/auto-hamid.webp",
        tag: "advideo",
        badge: "Vidéo publicitaire",
        title: "Auto hamid larache",
        url:  "https://www.facebook.com/reel/2615905811935303",
    },
    {
        img: "/our-references/baraka.webp",
        tag: "advideo",
        badge: "Vidéo publicitaire",
        title: "Kasr al baraka",
        url:  "https://www.facebook.com/reel/483578264461115",
    },{
        img: "/our-references/uk-cafe.webp",
        tag: "advideo",
        badge: "Vidéo publicitaire",
        title: "Uk cafe",
        url:  "https://www.facebook.com/reel/1659695201318779",
    },{
        img: "/our-references/grander-berry.webp",
        tag: "advideo",
        badge: "Vidéo publicitaire",
        title: "Grander berry",
        url:  "https://www.youtube.com/watch?v=eiRaI1UxT58",
    },{
        img: "/our-references/moulay.webp",
        tag: "advideo",
        badge: "Vidéo publicitaire",
        title:"Immobilier Moulay bousslham",
        url:  "https://www.youtube.com/watch?v=m5A1xviDP98",
    },{
        img: "/our-references/_green-land.webp",
        tag: "advideo",
        badge: "Vidéo publicitaire",
        title: "Green Land Larache",
        url:  "https://www.facebook.com/reel/1743155456206139",
    },
];
---



<section id="portfolio" class="portfolio section">
    <!-- Section Title -->
    <div class="container section-title">
        <h2>Portfolio</h2>
        <div>
            <span>Parmi nos références,</span>
            <span class="description-title" style="color:#e30f29"
                >des TPE, PME et Multinationales</span
            >
        </div>
    </div>
    <!-- End Section Title -->

    <div class="container-fluid" >
        <div
            class="isotope-layout"
            data-default-filter=".filter-website"
            data-layout="masonry"
            data-sort="original-order"
        >
            <ul class="portfolio-filters isotope-filters" >
               
                <li data-filter=".filter-website" class="filter-active">
                    <i class="bi bi-code-slash"></i> Conception de site web
                </li>
                <li data-filter=".filter-advertising">
                    <i class="bi bi-vector-pen"></i> Création publicitaire
                </li>
                <li data-filter=".filter-advideo">
                    <i class="bi bi-bar-chart-line"></i> Vidéo publicitaire
                </li>
                 <li data-filter="*" >
                    <i class="bi bi-grid-3x3"></i> Tous les projets
                </li>
            </ul>

            <div class="row g-4 isotope-container" >
                {portfolio.map((p) => (
                    <div
                      class={`col-xl-3 col-lg-4 col-md-6 col-6 portfolio-item isotope-item filter-${p.tag}`}
                    >
                      <article class="portfolio-entry">
                        <figure class="entry-image">
                          <div 
                            class="lazy-image" 
                            data-src={p.img} 
                            data-alt={p.title} 
                            data-width="100%" 
                            data-height="100%"
                          ></div>
                          <div class="entry-overlay">
                            <div class="overlay-content">
                              <div class="entry-meta badge bg-primary">{p.badge}</div>
                              <h3 class="entry-title">{p.title}</h3>
                              <div class="entry-links">
                                <a
                                  href={p.img}
                                  class="glightbox"
                                  data-gallery="portfolio-gallery-ui"
                                  data-glightbox={`title: ${p.title}; description: Praesent commodo cursus magna, vel scelerisque nisl consectetur.`}
                                >
                                  <i class="bi bi-arrows-angle-expand" />
                                </a>
                                <a href={p.url} target="_blank">
                                  <i class="bi bi-arrow-right" />
                                </a>
                              </div>
                            </div>
                          </div>
                        </figure>
                      </article>
                    </div>
                  ))}
                  

               
            </div>
            <!-- End Portfolio Container -->
        </div>
    </div>
</section>


<script>
    document.addEventListener("DOMContentLoaded", () => {
      const servicesSection = document.getElementById("services");
  
      const loadPortfolioImages = () => {
        document.querySelectorAll(".lazy-image").forEach((placeholder) => {
          if (!placeholder.dataset.src) return;
  
          const img = document.createElement("img");
          img.src = placeholder.dataset.src;
          img.alt = placeholder.dataset.alt || "";
          img.width = placeholder.dataset.width || "100%";
          img.height = placeholder.dataset.height || "100%";
          img.loading = "lazy";
          img.className = "img-fluid";
  
          placeholder.replaceWith(img);
        });
      };
  
      if (!servicesSection) return;
  
      // ✅ Function to check if #services is already visible on page load
      const isInViewport = (el) => {
        const rect = el.getBoundingClientRect();
        return (
          rect.top < window.innerHeight && 
          rect.bottom >= 0
        );
      };
  
      // Case 1: already in viewport at page load (refresh on footer, etc.)
      if (isInViewport(servicesSection)) {
        loadPortfolioImages();
        return; // no need to observe
      }
  
      // Case 2: wait for scroll into view
      if ("IntersectionObserver" in window) {
        const observer = new IntersectionObserver((entries) => {
          entries.forEach((entry) => {
            if (entry.isIntersecting) {
              loadPortfolioImages();
              observer.disconnect();
            }
          });
        });
  
        observer.observe(servicesSection);
      } else {
        // fallback for old browsers
        loadPortfolioImages();
      }
    });
  </script>
  
  
  