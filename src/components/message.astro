---

---

<link
  rel="preload"
  href="/assets/styles/message.css"
  as="style"
  onload="this.onload=null;this.rel='stylesheet'"
/>

<script src="https://cdn.jsdelivr.net/npm/emailjs-com@3.2.0/dist/email.min.js"
></script>

<div class="chat-container hidden" id="chat-box">
  <div class="chat-header">
    <button class="close-btn" id="closeChat">
      <i class="bi bi-x"></i>
    </button>
    <p style="margin: 0;">BROSMEDIA Assistant IA</p>
  </div>

  <div class="chat-body" id="chatBody">
    <div class="message-row receiver">
      <div class="message-bubble">
        üëã Bonjour et bienvenue chez Brosmedia ! Je suis votre assistant IA ü§ñ
        sp√©cialis√© en marketing digital. Comment puis-je vous aider aujourd‚Äôhui
        ?
        <div class="quick-replies">
          <div class="quick-reply" data-reply="Services">
            D√©couvrir nos services
          </div>
          <div class="quick-reply" data-reply="Tarifs">
            Consulter nos tarifs
          </div>
          <div class="quick-reply" data-reply="Portfolio">
            Voir notre portfolio
          </div>
          <div class="quick-reply" data-reply="Contact">
            Parler √† un conseiller
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<script>
  document.addEventListener("DOMContentLoaded", function () {
    (function () {
      emailjs.init("a0BnjUTyKVDvAuKZT");
    })();

    const chatBox = document.getElementById("chat-box");
    const closeChat = document.getElementById("closeChat");
    const chatBody = document.getElementById("chatBody");
    // const chatMessage = document.getElementById("chatMessage");
    const sendBtn = document.getElementById("sendBtn");
    const micIcon = document.getElementById("micIcon");
    const fileIcon = document.getElementById("fileIcon");
    const chatBtn = document.getElementById("chat-button");

    // AI Responses with more natural language
    const AI_RESPONSES = {
      greeting: [
        "Bonjour ! Je suis l'assistant IA de Brosmedia. ü§ñ Comment puis-je vous aider aujourd'hui?",
        "Salut ! üëã Ravie de vous rencontrer. Je suis l√† pour r√©pondre √† toutes vos questions sur nos services de communication et web marketing.",
      ],
      services: `Bien s√ªr üöÄ ! Chez Brosmedia, nous aidons les entreprises √† d√©velopper leur pr√©sence en ligne gr√¢ce √† :
<br>
‚Ä¢ üåê Cr√©ation de sites web modernes et rapides<br>
‚Ä¢ üìà SEO & R√©f√©rencement Google<br>
‚Ä¢ üéØ Publicit√© digitale (Facebook, Instagram, Google)<br>
‚Ä¢ üé• Contenu audiovisuel (photos & vid√©os professionnelles)<br>
üëâ Quel domaine vous int√©resse le plus ?`,
      Sites_web: `Excellent choix üåê ! Nous cr√©ons des sites web :<br>
100% responsives (adapt√©s √† mobile, tablette, PC)<br>
Rapides ‚ö° et optimis√©s pour Google<br>
Avec un design moderne et personnalis√© üé®<br>
Et une gestion facile pour vous<br>
voulez-vous que je vous explique nos formules et tarifs pour un site ?`,
      pricing: `Tr√®s bien üëç Voici un aper√ßu :<br>

‚Ä¢ Pack Starter : site vitrine simple, √† partir de 5 000 MAD<br>
‚Ä¢ Pack Business : site complet avec optimisation SEO, √† partir de 9 000 MAD<br>
‚Ä¢ Pack Premium : site personnalis√© avec r√©servation en ligne, √† partir de 15 000 MAD<br> <br>
Tous nos sites incluent : h√©bergement s√©curis√©, certificat SSL, et support technique 12 mois.<br> <br>
üëâ Voulez-vous que je pr√©pare un devis personnalis√© pour votre entreprise ?`,

      PrepareQuote: `Parfait ! üéØ Pour pr√©parer un devis rapide, j‚Äôai besoin de quelques informations :<br>`,

      portfolio: `üëâ Souhaitez-vous que je vous pr√©sente un exemple concret de votre domaine d'activit√©¬†?<br>`,

      Publicit√©: `La publicit√© digitale, c‚Äôest le moyen le plus rapide pour g√©n√©rer des clients.
Nous g√©rons pour vous :<br><br>

‚Ä¢ Campagnes Facebook & Instagram Ads<br>
‚Ä¢ Campagnes Google Ads<br>
‚Ä¢ Ciblage pr√©cis de vos prospects<br>
‚Ä¢ Suivi et optimisation en temps r√©el<br><br>

Quel est votre objectif principal ?`,

      VideoPhoto: `Le contenu visuel est la cl√© pour convaincre vos clients üëÄ.<br>
Chez Brosmedia, nous r√©alisons :<br>

‚Ä¢ üì∏ Shooting photo professionnel<br>
‚Ä¢ üé¨ Vid√©os promotionnelles<br>
‚Ä¢ üé• Spots publicitaires pour r√©seaux sociaux<br>
‚Ä¢ üè¢ Pr√©sentations corporate<br><br>

üëâ Quel type de contenu vous int√©resse le plus ?`,

      packs: `Voici un aper√ßu de nos formules üìä :<br>

‚Ä¢ Pack Starter: id√©al pour d√©buter en ligne, √† partir de 5 000 MAD<br>
‚Ä¢ Pack Business: pour d√©velopper votre pr√©sence, √† partir de 9 000 MAD<br>
‚Ä¢ Pack Premium: solution compl√®te, √† partir de 15 000 MAD<br> <br>
üëâ Voulez-vous que je vous aide √† identifier le pack le plus adapt√© √† votre activit√© ?`,

      contact: `Tr√®s bien ! Je vous mets en relation avec un membre de notre √©quipe.<br>
        Mais avant, pour mieux vous orienter, pouvez-vous pr√©ciser votre demande ?
        `,
      otherRequest: `D‚Äôaccord ! Pour que nous puissions vous r√©pondre pr√©cis√©ment, merci de nous expliquer bri√®vement votre besoin et de fournir votre email üì©`,
=======
      contact:
        "Excellent! Un de nos experts vous contactera dans les plus brefs d√©lais. üòä",
>>>>>>> d274e2fe77923c326ce7467eb275eed2f3e83cb1
      default: [
        "Je ne suis pas s√ªr de comprendre. Pourriez-vous reformuler votre question?",
        "C'est une bonne question! Laissez-moi vous mettre en contact avec un expert humain qui pourra vous aider.",
        "Je suis encore en apprentissage. Pourriez-vous essayer de formuler votre demande autrement?",
      ],
    };

    // Services list
    const SERVICES = [
      "Cr√©ation de site web",
      "Design graphique",
      "Marketing digital",
      "Maintenance technique",
      "Formation en ligne",
      "Autres",
    ];

    if (chatBtn) {
      chatBtn.addEventListener("click", (e) => {
        e.preventDefault();

        // Desktop ‚Üí toggle chatBox
        chatBox.classList.toggle("hidden");
      });
    }

    closeChat.addEventListener("click", function () {
      chatBox.classList.add("hidden");
    });

    // Add message to chat
    function addMessage(text, sender) {
      const messageRow = document.createElement("div");
      messageRow.classList.add("message-row");
      messageRow.classList.add(sender === "user" ? "sender" : "receiver");

      const messageBubble = document.createElement("div");
      messageBubble.classList.add("message-bubble");

      // Check if the text contains HTML tags
      if (/<[a-z][\s\S]*>/i.test(text)) {
        messageBubble.innerHTML = text;
      } else {
        messageBubble.textContent = text;
      }

      messageRow.appendChild(messageBubble);
      chatBody.appendChild(messageRow);

      // Scroll to bottom
      chatBody.scrollTop = chatBody.scrollHeight;
    }

<<<<<<< HEAD
    function showQuoteFormForVideoPhoto(msg) {
      addMessage(
        `Afin de vous proposer une offre Vid√©o & Photo adapt√©e √† vos besoins, pourriez-vous s‚Äôil vous pla√Æt remplir ce formulaire avec votre email et num√©ro de t√©l√©phone ?`,
        "ai",
      );

      const quoteForm = document.createElement("div");
      quoteForm.id = "VideoPhoto";
      quoteForm.classList.add("contact-form");

      quoteForm.innerHTML = `
    <h3>Demande de Devis</h3>

    <div class="form-group">
      <label for="userEmail">Votre email</label>
      <input type="email" id="userEmailVideoPhoto" placeholder="votre@email.com">
    </div>

    <div class="form-group">
      <label for="userPhone">Votre t√©l√©phone</label>
      <input type="text" id="userPhoneVideoPhoto" placeholder="+2126123456789">
    </div>
    
    <div class="form-buttons">
      <button class="cancel-btn" id="cancelQuoteVideoPhoto">Annuler</button>
      <button class="submit-btn" id="submitQuoteVideoPhoto">Envoyer</button>
    </div>
  `;

      chatBody.appendChild(quoteForm);

      // Add event listeners
      document
        .getElementById("cancelQuoteVideoPhoto")
        .addEventListener("click", function () {
          quoteForm.remove();
        });

      document
        .getElementById("submitQuoteVideoPhoto")
        .addEventListener("click", async function () {
          const email = document.getElementById("userEmailVideoPhoto").value;
          const phone = document.getElementById("userPhoneVideoPhoto").value;

          if (!email) {
            alert("Veuillez remplir tous les champs obligatoires.");
            return;
          }

          try {
            // Prepare email template parameters
            const templateParams = {
              message: `Bonjour, je souhaite un devis pour Vid√©o & Photo service:
              Type de contenu: ${msg} \n
        Email: ${email} \n
        Telephone: ${phone}
       `,
              reply_to: email,
            };

            // Send email using EmailJS
            await emailjs.send(
              "service_8hmb2eq",
              "template_jmcu1f9",
              templateParams,
            );

            addMessage(
              `Une fois ces infos re√ßues, notre √©quipe vous enverra une proposition sous 24h üì©`,
              "ai",
            );

            // Remove form
            if (quoteForm) {
              quoteForm.remove();
            }
          } catch (error) {
            console.error("Error:", error);
            addMessage(
              "D√©sol√©, une erreur s'est produite lors de l'envoi de votre demande. Veuillez r√©essayer.",
              "ai",
            );
          }
        });

      // Scroll to bottom
      chatBody.scrollTop = chatBody.scrollHeight;
    }

    function showQuoteFormForCustomePack() {
      addMessage(
        `Pour vous proposer le pack le plus adapt√© √† vos besoins, merci de remplir ce formulaire avec votre secteur d‚Äôactivit√©, objectif principal, email et num√©ro de t√©l√©phone.<br>`,
        "ai",
      );

      const quoteForm = document.createElement("div");
      quoteForm.id = "CustomePack";
      quoteForm.classList.add("contact-form");

      quoteForm.innerHTML = `
    <h3>D√©crivez vos besoins</h3>
    

      <div class="form-group">
      <label for="sectorOfActivity">Votre secteur d‚Äôactivit√©</label>
      <input type="text" id="sectorOfActivity" placeholder="Ex: Restauration, Immobilier, Sant√©...">
    </div>

    <div class="form-group">
      <label>Votre objectif principal</label>
      <div class="service-tags">
        <div class="service-tag" data-objective="visibilit√©">Visibilit√©</div>
        <div class="service-tag" data-objective="clients">Clients</div>
        <div class="service-tag" data-objective="ventes en ligne">Ventes en ligne</div>
        <div class="service-tag" data-objective="image de marque">Image de marque</div>
      </div>
      </div>
    </div>
    
    <div class="form-group">
      <label for="userEmail">Votre email</label>
      <input type="email" id="userEmailCustomePack" placeholder="votre@email.com">
    </div>

    <div class="form-group">
      <label for="userPhone">Votre t√©l√©phone</label>
      <input type="text" id="userPhoneCustomePack" placeholder="+2126123456789">
    </div>
    
    <div class="form-buttons">
      <button class="cancel-btn" id="cancelCustomePack">Annuler</button>
      <button class="submit-btn" id="submitCustomePack">Envoyer</button>
    </div>
  `;

      chatBody.appendChild(quoteForm);

      // Add event listeners
      document
        .getElementById("cancelCustomePack")
        .addEventListener("click", function () {
          quoteForm.remove();
        });

      // Add selection functionality to all service tags
      document.querySelectorAll("#CustomePack .service-tag").forEach((tag) => {
        tag.addEventListener("click", function () {
          // Only allow one selection per group
          const parentGroup = this.closest(".form-group");
          parentGroup
            .querySelectorAll(".service-tag")
            .forEach((t) => t.classList.remove("selected"));
          this.classList.add("selected");
        });
      });

      document
        .getElementById("submitCustomePack")
        .addEventListener("click", async function () {
          const objectiv =
            document.querySelector("#CustomePack [data-objective].selected")
              ?.dataset.objective || "Non sp√©cifi√©";

          const email = document.getElementById("userEmailCustomePack").value;
          const phone = document.getElementById("userPhoneCustomePack").value;
          const sector = document.getElementById("sectorOfActivity").value;

          if (!sector || !email) {
            alert("Veuillez remplir tous les champs obligatoires.");
            return;
          }

          try {
            // Prepare email template parameters
            const templateParams = {
              message: `Pack personnalis√©:
        Secteur d‚Äôactivit√© : ${sector} \n
        L'objectif : ${objectiv} \n
        Email: ${email} \n
        Telephone: ${phone}
       `,
              reply_to: email,
            };

            // Send email using EmailJS
            await emailjs.send(
              "service_8hmb2eq",
              "template_jmcu1f9",
              templateParams,
            );

            addMessage(
              `Une fois ces infos re√ßues, notre √©quipe vous enverra une proposition sous 24h üì©`,
              "ai",
            );

            // Remove form
            if (quoteForm) {
              quoteForm.remove();
            }
          } catch (error) {
            console.error("Error:", error);
            addMessage(
              "D√©sol√©, une erreur s'est produite lors de l'envoi de votre demande. Veuillez r√©essayer.",
              "ai",
            );
          }
        });

      // Scroll to bottom
      chatBody.scrollTop = chatBody.scrollHeight;
    }

    function showQuoteFormForChoosePack() {
      addMessage(
        `Choisissez le pack que vous souhaitez üéØ et indiquez votre email et num√©ro de t√©l√©phone pour recevoir tous les d√©tails.<br>`,
        "ai",
      );

      const quoteForm = document.createElement("div");
      quoteForm.id = "ChoosePack";
      quoteForm.classList.add("contact-form");

      quoteForm.innerHTML = `
    <h3>Choisissez votre offre</h3>
    
    <div class="form-group">
      <label>Choix du pack</label>
      <div class="service-tags">
        <div class="service-tag" data-objective="pack starter">Pack Starter</div>
        <div class="service-tag" data-objective="pack business">Pack Business</div>
        <div class="service-tag" data-objective="pack premium">Pack Premium</div>
      </div>
    </div>
    
    <div class="form-group">
      <label for="userEmail">Votre email</label>
      <input type="email" id="userEmailChoosePack" placeholder="votre@email.com">
    </div>

    <div class="form-group">
      <label for="userPhone">Votre t√©l√©phone</label>
      <input type="text" id="userPhoneChoosePack" placeholder="+2126123456789">
    </div>
    
    <div class="form-buttons">
      <button class="cancel-btn" id="cancelChoosePack">Annuler</button>
      <button class="submit-btn" id="submitChoosePack">Envoyer</button>
    </div>
  `;

      chatBody.appendChild(quoteForm);

      // Add event listeners
      document
        .getElementById("cancelChoosePack")
        .addEventListener("click", function () {
          quoteForm.remove();
        });

      // Add selection functionality to all service tags
      document.querySelectorAll("#ChoosePack .service-tag").forEach((tag) => {
        tag.addEventListener("click", function () {
          // Only allow one selection per group
          const parentGroup = this.closest(".form-group");
          parentGroup
            .querySelectorAll(".service-tag")
            .forEach((t) => t.classList.remove("selected"));
          this.classList.add("selected");
        });
      });

      document
        .getElementById("submitChoosePack")
        .addEventListener("click", async function () {
          const pack =
            document.querySelector("#ChoosePack [data-objective].selected")
              ?.dataset.objective || "Non sp√©cifi√©";

          const email = document.getElementById("userEmailChoosePack").value;
          const phone = document.getElementById("userPhoneChoosePack").value;

          if (!pack || !email) {
            alert("Veuillez remplir tous les champs obligatoires.");
            return;
          }

          try {
            // Prepare email template parameters
            const templateParams = {
              message: `S√©lectionnez une offre:
        Pack: ${pack} \n
        Email: ${email} \n
        Telephone: ${phone}
       `,
              reply_to: email,
            };

            // Send email using EmailJS
            await emailjs.send(
              "service_8hmb2eq",
              "template_jmcu1f9",
              templateParams,
            );

            addMessage(
              `Une fois ces infos re√ßues, notre √©quipe vous enverra une proposition sous 24h üì©`,
              "ai",
            );

            // Remove form
            if (quoteForm) {
              quoteForm.remove();
            }
          } catch (error) {
            console.error("Error:", error);
            addMessage(
              "D√©sol√©, une erreur s'est produite lors de l'envoi de votre demande. Veuillez r√©essayer.",
              "ai",
            );
          }
        });

      // Scroll to bottom
      chatBody.scrollTop = chatBody.scrollHeight;
    }

    function showQuoteFormForPortfolio() {
      addMessage(
        `Pour vous montrer un exemple concret dans votre domaine, merci de remplir ce formulaire avec votre domaine d‚Äôactivit√©, votre email et votre num√©ro de t√©l√©phone.`,
        "ai",
      );

      const quoteForm = document.createElement("div");
      quoteForm.id = "Portfolio";
      quoteForm.classList.add("contact-form");

      quoteForm.innerHTML = `
    <h3>Exemple personnalis√©</h3>
    
<div class="form-group">
      <label for="userWebsite">Votre domaine d‚Äôactivit√©</label>
      <input type="text" id="userActivityPortfolio" placeholder="Ex: Restauration, Immobilier, Sant√©...">
    </div>

    <div class="form-group">
      <label for="userEmail">Votre email</label>
      <input type="email" id="userEmailPortfolio" placeholder="votre@email.com">
    </div>

    <div class="form-group">
      <label for="userPhone">Votre t√©l√©phone</label>
      <input type="text" id="userPhonePortfolio" placeholder="+2126123456789">
    </div>
    
    <div class="form-buttons">
      <button class="cancel-btn" id="cancelQuotePortfolio">Annuler</button>
      <button class="submit-btn" id="submitQuotePortfolio">Envoyer</button>
    </div>
  `;

      chatBody.appendChild(quoteForm);

      // Add event listeners
      document
        .getElementById("cancelQuotePortfolio")
        .addEventListener("click", function () {
          quoteForm.remove();
        });

      document
        .getElementById("submitQuotePortfolio")
        .addEventListener("click", async function () {
          const email = document.getElementById("userEmailPortfolio").value;
          const phone = document.getElementById("userPhonePortfolio").value;
          const activity = document.getElementById(
            "userActivityPortfolio",
          ).value;

          if (!activity || !email) {
            alert("Veuillez remplir tous les champs obligatoires.");
            return;
          }

          try {
            // Prepare email template parameters
            const templateParams = {
              message: `Bonjour üëã, j‚Äôaimerais voir un exemple de projet ou site dans mon secteur :
              Secteur: ${activity} \n
        Email: ${email} \n
        Telephone: ${phone}
       `,
              reply_to: email,
            };

            // Send email using EmailJS
            await emailjs.send(
              "service_8hmb2eq",
              "template_jmcu1f9",
              templateParams,
            );

            addMessage(
              `Une fois ces infos re√ßues, notre √©quipe vous enverra un exemple sous 24h üì©`,
              "ai",
            );

            // Remove form
            if (quoteForm) {
              quoteForm.remove();
            }
          } catch (error) {
            console.error("Error:", error);
            addMessage(
              "D√©sol√©, une erreur s'est produite lors de l'envoi de votre demande. Veuillez r√©essayer.",
              "ai",
            );
          }
        });

      // Scroll to bottom
      chatBody.scrollTop = chatBody.scrollHeight;
    }

    function showQuoteFormForSEO() {
      addMessage(
        `Le SEO est la cl√© pour appara√Ætre en haut des r√©sultats Google üöÄ.<br>
      Avec Brosmedia, nous vous aidons √† :<br>

‚Ä¢ Optimiser votre site pour Google<br>
‚Ä¢ Attirer plus de visiteurs qualifi√©s<br>
‚Ä¢ Gagner en visibilit√© locale et nationale<br>

Afin de vous proposer une strat√©gie SEO adapt√©e √† vos besoins, pourriez-vous s‚Äôil vous pla√Æt remplir ce formulaire avec votre site web, email et num√©ro de t√©l√©phone ?`,
        "ai",
      );

      const quoteForm = document.createElement("div");
      quoteForm.id = "SEO";
      quoteForm.classList.add("contact-form");

      quoteForm.innerHTML = `
    <h3>Demande de Devis</h3>
    
<div class="form-group">
      <label for="userWebsite">Votre site Web</label>
      <input type="text" id="userWebsiteSeo" placeholder="https://brosmedia.ma/">
    </div>

    <div class="form-group">
      <label for="userEmail">Votre email</label>
      <input type="email" id="userEmailSeo" placeholder="votre@email.com">
    </div>

    <div class="form-group">
      <label for="userPhone">Votre t√©l√©phone</label>
      <input type="text" id="userPhoneSeo" placeholder="+2126123456789">
    </div>
    
    <div class="form-buttons">
      <button class="cancel-btn" id="cancelQuoteSEO">Annuler</button>
      <button class="submit-btn" id="submitQuoteSEO">Envoyer</button>
    </div>
  `;

      chatBody.appendChild(quoteForm);

      // Add event listeners
      document
        .getElementById("cancelQuoteSEO")
        .addEventListener("click", function () {
          quoteForm.remove();
        });

      document
        .getElementById("submitQuoteSEO")
        .addEventListener("click", async function () {
          const email = document.getElementById("userEmailSeo").value;
          const phone = document.getElementById("userPhoneSeo").value;
          const website = document.getElementById("userWebsiteSeo").value;

          if (!website || !email) {
            alert("Veuillez remplir tous les champs obligatoires.");
            return;
          }

          try {
            // Prepare email template parameters
            const templateParams = {
              message: `Bonjour, je souhaite un devis pour SEO service:
              Site Web: ${website} \n
        Email: ${email} \n
        Telephone: ${phone}
       `,
              reply_to: email,
            };

            // Send email using EmailJS
            await emailjs.send(
              "service_8hmb2eq",
              "template_jmcu1f9",
              templateParams,
            );

            addMessage(
              `Une fois ces infos re√ßues, notre √©quipe vous enverra une proposition sous 24h üì©`,
              "ai",
            );

            // Remove form
            if (quoteForm) {
              quoteForm.remove();
            }
          } catch (error) {
            console.error("Error:", error);
            addMessage(
              "D√©sol√©, une erreur s'est produite lors de l'envoi de votre demande. Veuillez r√©essayer.",
              "ai",
            );
          }
        });

      // Scroll to bottom
      chatBody.scrollTop = chatBody.scrollHeight;
    }

    function showQuoteFormForDigitalAdvertisingObjective(message) {
      addMessage(
        `Parfait üöÄ ! Donc, si votre objectif est <b>${message}</b>, on peut vous proposer une campagne cibl√©e adapt√©e √† votre secteur et √† votre ville.<br>`,
        "ai",
      );

      addMessage(
        `üëâ Pouvez-vous m‚Äôindiquer votre email pour recevoir la proposition ?<br>`,
        "ai",
      );

      const quoteForm = document.createElement("div");
      quoteForm.id = "DigitalAdvertisingObjective";
      quoteForm.classList.add("contact-form");

      quoteForm.innerHTML = `
    <h3>Demande de Devis</h3>
    
    <div class="form-group">
      <label for="userEmail">Votre email</label>
      <input type="email" id="userEmail" placeholder="votre@email.com">
    </div>

    <div class="form-group">
      <label for="userPhone">Votre t√©l√©phone</label>
      <input type="text" id="userPhone" placeholder="+2126123456789">
    </div>
    
    <div class="form-buttons">
      <button class="cancel-btn" id="cancelQuoteDigitalAdvertisingObjective">Annuler</button>
      <button class="submit-btn" id="submitQuoteDigitalAdvertisingObjective">Envoyer</button>
    </div>
  `;

      chatBody.appendChild(quoteForm);

      // Add event listeners
      document
        .getElementById("cancelQuoteDigitalAdvertisingObjective")
        .addEventListener("click", function () {
          quoteForm.remove();
        });

      document
        .getElementById("submitQuoteDigitalAdvertisingObjective")
        .addEventListener("click", async function () {
          const email = document.getElementById("userEmail").value;
          const phone = document.getElementById("userPhone").value;

          if (!email) {
            alert("Veuillez remplir tous les champs obligatoires.");
            return;
          }

          try {
            // Prepare email template parameters
            const templateParams = {
              message: `Bonjour, je souhaite un devis pour Publicit√© num√©rique service:
              L'objectif: ${message} \n
        Email: ${email} \n
        Telephone: ${phone}
       `,
              reply_to: email,
            };

            // Send email using EmailJS
            await emailjs.send(
              "service_8hmb2eq",
              "template_jmcu1f9",
              templateParams,
            );

            addMessage(
              `Une fois ces infos re√ßues, notre √©quipe vous enverra une proposition sous 24h üì©`,
              "ai",
            );

            // Remove form
            if (quoteForm) {
              quoteForm.remove();
            }
          } catch (error) {
            console.error("Error:", error);
            addMessage(
              "D√©sol√©, une erreur s'est produite lors de l'envoi de votre demande. Veuillez r√©essayer.",
              "ai",
            );
          }
        });

      // Scroll to bottom
      chatBody.scrollTop = chatBody.scrollHeight;
    }

    function showQuoteForm() {
      addMessage(
        `Parfait ! üéØ Pour pr√©parer un devis rapide, j‚Äôai besoin de quelques informations :<br>`,
        "ai",
      );

      const quoteForm = document.createElement("div");
      quoteForm.id = "QuoteForm";
      quoteForm.classList.add("contact-form");

      quoteForm.innerHTML = `
    <h3>Demande de Devis</h3>
    <div class="form-group">
      <label for="sector">Quel est votre secteur d‚Äôactivit√© ?</label>
      <input type="text" id="sector" placeholder="Ex: Restauration, Immobilier, Sant√©...">
    </div>
    <div class="form-group">
      <label>Quel est votre objectif principal ?</label>
      <div class="service-tags">
        <div class="service-tag" data-objective="plus de clients">Plus de clients</div>
        <div class="service-tag" data-objective="plus de visibilit√©">Plus de visibilit√©</div>
        <div class="service-tag" data-objective="meilleure image de marque">Meilleure image de marque</div>
      </div>
    </div>
    <div class="form-group">
      <label>Type de site pr√©f√©r√© ?</label>
      <div class="service-tags">
        <div class="service-tag" data-type="site vitrine">Site vitrine</div>
        <div class="service-tag" data-type="e-commerce">E-commerce</div>
        <div class="service-tag" data-type="r√©servation en ligne">R√©servation en ligne</div>
      </div>
    </div>
    <div class="form-group">
      <label>Options SEO :</label>
      <div class="service-tags">
        <div class="service-tag" data-seo="oui">Oui, ajoutez le SEO</div>
        <div class="service-tag" data-seo="non">Non, seulement le site</div>
      </div>
    </div>
    <div class="form-group">
      <label for="userEmail">Votre email</label>
      <input type="email" id="userEmail" placeholder="votre@email.com">
    </div>

    <div class="form-group">
      <label for="userPhone">Votre t√©l√©phone</label>
      <input type="text" id="userPhone" placeholder="+2126123456789">
    </div>
    
    <div class="form-buttons">
      <button class="cancel-btn" id="cancelQuote">Annuler</button>
      <button class="submit-btn" id="submitQuote">Envoyer</button>
    </div>
  `;

      chatBody.appendChild(quoteForm);

      // Add event listeners
      document
        .getElementById("cancelQuote")
        .addEventListener("click", function () {
          quoteForm.remove();
        });

      // Add selection functionality to all service tags
      document.querySelectorAll("#QuoteForm .service-tag").forEach((tag) => {
        tag.addEventListener("click", function () {
          // Only allow one selection per group
          const parentGroup = this.closest(".form-group");
          parentGroup
            .querySelectorAll(".service-tag")
            .forEach((t) => t.classList.remove("selected"));
          this.classList.add("selected");
        });
      });

      document
        .getElementById("submitQuote")
        .addEventListener("click", async function () {
          const sector = document.getElementById("sector").value;
          const objective =
            document.querySelector("#QuoteForm [data-objective].selected")
              ?.dataset.objective || "Non sp√©cifi√©";
          const siteType =
            document.querySelector("#QuoteForm [data-type].selected")?.dataset
              .type || "Non sp√©cifi√©";
          const seoOption =
            document.querySelector("#QuoteForm [data-seo].selected")?.dataset
              .seo || "Non sp√©cifi√©";
          const email = document.getElementById("userEmail").value;
          const phone = document.getElementById("userPhone").value;

          if (!sector || !email) {
            alert("Veuillez remplir tous les champs obligatoires.");
            return;
          }

          try {
            // Prepare email template parameters
            const templateParams = {
<<<<<<< HEAD
              message: `Bonjour, je souhaite un devis pour Cr√©ation de site Web service:
=======
              message: `Bonjour, je souhaite un devis pour:
>>>>>>> d274e2fe77923c326ce7467eb275eed2f3e83cb1
        Secteur: ${sector} \n
        Objectif: ${objective} \n
        Type de site: ${siteType} \n
        SEO: ${seoOption} \n
        Email: ${email} \n
        Telephone: ${phone}
       `,
              reply_to: email,
            };

            // Send email using EmailJS
            await emailjs.send(
              "service_8hmb2eq",
              "template_jmcu1f9",
              templateParams,
            );

            addMessage(
              `Une fois ces infos re√ßues, notre √©quipe vous enverra une proposition sous 24h üì©`,
              "ai",
            );

            // Remove form
            if (quoteForm) {
              quoteForm.remove();
            }
          } catch (error) {
            console.error("Error:", error);
            addMessage(
              "D√©sol√©, une erreur s'est produite lors de l'envoi de votre demande. Veuillez r√©essayer.",
              "ai",
            );
          }
        });

      // Scroll to bottom
      chatBody.scrollTop = chatBody.scrollHeight;
    }

    // Show typing indicator
    function showTypingIndicator() {
      const typingRow = document.createElement("div");
      typingRow.classList.add("message-row");
      typingRow.classList.add("receiver");
      typingRow.id = "typingIndicator";

      const typingBubble = document.createElement("div");
      typingBubble.classList.add("typing-indicator");

      for (let i = 0; i < 3; i++) {
        const dot = document.createElement("div");
        dot.classList.add("typing-dot");
        typingBubble.appendChild(dot);
      }

      typingRow.appendChild(typingBubble);
      chatBody.appendChild(typingRow);

      // Scroll to bottom
      chatBody.scrollTop = chatBody.scrollHeight;
    }

    // Remove typing indicator
    function removeTypingIndicator() {
      const typingIndicator = document.getElementById("typingIndicator");
      if (typingIndicator) {
        typingIndicator.remove();
      }
    }

    // AI Response logic
    function aiResponse(userMessage) {
      const lowerMessage = userMessage.toLowerCase();
      let response = "";

      if (
        lowerMessage.includes("bonjour") ||
        lowerMessage.includes("salut") ||
        lowerMessage.includes("hello") ||
        lowerMessage.includes("coucou")
      ) {
        response =
          AI_RESPONSES.greeting[
            Math.floor(Math.random() * AI_RESPONSES.greeting.length)
          ];
<<<<<<< HEAD
      } else if (lowerMessage.includes(" les tarifs")) {
=======
      } else if (
        lowerMessage.includes("prix") ||
        lowerMessage.includes("tarif") ||
        lowerMessage.includes("combien") ||
        lowerMessage.includes("co√ªt") ||
        lowerMessage.includes("budget")
      ) {
>>>>>>> d274e2fe77923c326ce7467eb275eed2f3e83cb1
        response = AI_RESPONSES.pricing;
      } else if (
        lowerMessage.includes("portfolio") ||
        lowerMessage.includes("r√©alisation") ||
        lowerMessage.includes("projet") ||
        lowerMessage.includes("travail") ||
        lowerMessage.includes("exp√©rience")
      ) {
        response = AI_RESPONSES.portfolio;
<<<<<<< HEAD
      } else if (lowerMessage.includes("tarifs")) {
        response = AI_RESPONSES.packs;
      } else if (lowerMessage.includes("sites web")) {
        response = AI_RESPONSES.Sites_web;
      } else if (lowerMessage.includes("pr√©parez un devis")) {
        showQuoteForm();
      } else if (
        lowerMessage.includes(
          "je veux d‚Äôabord voir vos services en publicit√©",
        ) ||
        lowerMessage.includes("publicit√©")
      ) {
=======
      } else if (
        lowerMessage.includes("sites") ||
        lowerMessage.includes("web")
      ) {
        response = AI_RESPONSES.Sites_web;
      } else if (lowerMessage.includes("pr√©parez un devis")) {
        showQuoteForm();
      } else if (lowerMessage.includes("services en publicit")) {
>>>>>>> d274e2fe77923c326ce7467eb275eed2f3e83cb1
        response = AI_RESPONSES.Publicit√©;
      } else if (
        lowerMessage.includes("service") ||
        lowerMessage.includes("offre") ||
        lowerMessage.includes("quoi") ||
        lowerMessage.includes("propos")
      ) {
        response = AI_RESPONSES.services;
      } else if (
<<<<<<< HEAD
        lowerMessage.includes("attirer plus de clients rapidement") ||
        lowerMessage.includes("booster mes ventes en ligne") ||
        lowerMessage.includes("augmenter ma notori√©t√©")
      ) {
        showQuoteFormForDigitalAdvertisingObjective(lowerMessage);
      } else if (lowerMessage.includes("vid√©o & photo")) {
        response = AI_RESPONSES.VideoPhoto;
      } else if (lowerMessage == "autre demande") {
        response = AI_RESPONSES.otherRequest;
      } else if (
        lowerMessage == "vid√©o promotionnelle" ||
        lowerMessage == "photos produits" ||
        lowerMessage == "spot publicitaire" ||
        lowerMessage == "autre"
      ) {
        showQuoteFormForVideoPhoto(lowerMessage);
      } else if (lowerMessage == "seo") {
        showQuoteFormForSEO();
      } else if (lowerMessage.includes("aidez-moi √† choisir")) {
        showQuoteFormForCustomePack();
      } else if (
        lowerMessage.includes("je pr√©f√®re demander un devis directement")
      ) {
        showQuoteFormForChoosePack();
      } else if (
        lowerMessage.includes("montrez-moi un exemple de mon domaine")
      ) {
        showQuoteFormForPortfolio();
      } else if (lowerMessage.includes("devis pour un site web")) {
        showQuoteForWebsite();
      } else if (lowerMessage.includes("strat√©gie publicitaire")) {
        showAdvertisingStrategy();
      } else if (lowerMessage == "conseil seo") {
        showSEOConsulting();
      } else if (lowerMessage == "envoyer ma demande et √™tre contact√©") {
        showOtherRequest();
      }
      else if (lowerMessage == "parler directement √† un conseiller") {
        speakDirectlyToAdvisor();
      } else if (lowerMessage == "contact") {
        response = AI_RESPONSES.contact;
=======
        ("",
        "",
        "",
        lowerMessage.includes("Attirer plus de clients rapidement") ||
          lowerMessage.includes("Booster mes ventes en ligne") ||
          lowerMessage.includes("Augmenter ma notori√©t√©"))
      ) {
        response = AI_RESPONSES.services;
      } else if (
        lowerMessage.includes("contact") ||
        lowerMessage.includes("email") ||
        lowerMessage.includes("t√©l√©phone") ||
        lowerMessage.includes("adresse") ||
        lowerMessage.includes("appeler") ||
        lowerMessage.includes("humain") ||
        lowerMessage.includes("expert")
      ) {
        showContactForm();
>>>>>>> d274e2fe77923c326ce7467eb275eed2f3e83cb1
      } else {
        response =
          AI_RESPONSES.default[
            Math.floor(Math.random() * AI_RESPONSES.default.length)
          ];
      }

<<<<<<< HEAD
      if (response != "") {
        addMessage(response, "ai");
      }

      // Add quick replies after AI response
      // if (
      //   !lowerMessage.includes("humain") &&
      //   !lowerMessage.includes("expert")
      // ) {
      setTimeout(addQuickReplies(userMessage), 300);
      // }
    }

    function showOtherRequest() {
      const contactForm = document.createElement("div");
      contactForm.id = "OtherRequest";
      contactForm.classList.add("contact-form");

      // addMessage(
      //   `Le SEO est la cl√© pour appara√Ætre en haut des r√©sultats Google üöÄ<br>
      //   Pour vous aider efficacement, j‚Äôai besoin de :`,
      //   "ai",
      // );

      contactForm.innerHTML = `
    <h3>Demande de Devis</h3>
                    <div class="form-group">
                        <label for="requestOtherRequest">Votre demande</label>
                        <textarea id="requestOtherRequest"></textarea>
                    </div>
                    <div class="form-group">
                        <label for="userEmailOtherRequest">Votre email</label>
                        <input type="email" id="userEmailOtherRequest" placeholder="votre@email.com">
                    </div>
                     <div class="form-group">
                        <label for="userPhoneOtherRequest">Votre t√©l√©phone</label>
                        <input type="text" id="userPhoneOtherRequest" placeholder="+212123456789">
                    </div>
                    <div class="form-buttons">
                        <button class="cancel-btn" id="cancelOtherRequest">Annuler</button>
                        <button class="submit-btn" id="submitOtherRequest">Envoyer</button>
                    </div>
                `;

      chatBody.appendChild(contactForm);

      // Add event listeners
      document
        .getElementById("cancelOtherRequest")
        .addEventListener("click", function () {
          contactForm.remove();
        });

      document
        .getElementById("submitOtherRequest")
        .addEventListener("click", async function () {
          const request = document.getElementById("requestOtherRequest").value;
          const email = document.getElementById("userEmailOtherRequest").value;
          const phone = document.getElementById("userPhoneOtherRequest").value;

          if (!request || !email) {
            alert("Veuillez remplir tous les champs obligatoires.");
            return;
          }

          try {
            // Prepare email template parameters
            const templateParams = {
              message: `Bonjour, je souhaite un devis:
        Demande: ${request} \n
        Email: ${email} \n
        Telephone: ${phone}
       `,
              reply_to: email,
            };

            // Send email using EmailJS instead of localhost
            await emailjs.send(
              "service_8hmb2eq",
              "template_jmcu1f9",
              templateParams,
            );

            const whatsappUrl = `https://wa.me/212671884968`;

            addMessage(
              `Notre √©quipe vous enverra une proposition sous 24h.`,
              "ai",
            );

            // Remove form
            if (contactForm) {
              contactForm.remove();
            }
          } catch (error) {
            console.error("Error:", error);
            addMessage(
              "D√©sol√©, une erreur s'est produite lors de l'envoi de votre message. Veuillez r√©essayer.",
              "ai",
            );
          }
        });

      // Scroll to bottom
      chatBody.scrollTop = chatBody.scrollHeight;
    }

    function speakDirectlyToAdvisor() {
      const whatsappUrl = `https://wa.me/212671884968`;

      addMessage(
        `Vous pouvez parler directement avec un conseiller pour toutes vos questions et obtenir plus de d√©tails via WhatsApp: <br>
            <a href="${whatsappUrl}" target="_blank" style="color: #0a0f4f; text-decoration: underline;">
                Cliquez ici pour d√©marrer la conversation
            </a>`,
        "ai",
      );
    }

    function showSEOConsulting() {
      const contactForm = document.createElement("div");
      contactForm.id = "SEOConsulting";
      contactForm.classList.add("contact-form");

      addMessage(
        `Le SEO est la cl√© pour appara√Ætre en haut des r√©sultats Google üöÄ<br>
        Pour vous aider efficacement, j‚Äôai besoin de :`,
=======
      addMessage(response, "ai");

      // Add quick replies after AI response
      if (
        !lowerMessage.includes("contact") &&
        !lowerMessage.includes("humain") &&
        !lowerMessage.includes("expert")
      ) {
        setTimeout(addQuickReplies(userMessage), 300);
      }
    }

    // Show contact form
    function showContactForm() {
      const contactForm = document.createElement("div");
      contactForm.classList.add("contact-form");

      addMessage(
        "Parfait! Je vais vous mettre en contact avec un expert Brosmedia. Pourriez-vous me fournir quelques d√©tails?",
>>>>>>> d274e2fe77923c326ce7467eb275eed2f3e83cb1
        "ai",
      );

      contactForm.innerHTML = `
<<<<<<< HEAD
    <h3>Demande de Devis</h3>
                    <div class="form-group">
                        <label for="sectorSEOConsulting">Votre secteur d‚Äôactivit√©</label>
                        <input type="text" id="sectorSEOConsulting" placeholder="Ex: Restauration, Immobilier, Sant√©...">
                    </div>
                    <div class="form-group">
                        <label for="urlSEOConsulting">L‚ÄôURL de votre site </label>
                        <input type="text" id="urlSEOConsulting" placeholder="https://brosmedia.ma/">
                    </div>
                    <div class="form-group">
                        <label for="userEmailSEOConsulting">Votre email</label>
                        <input type="email" id="userEmailSEOConsulting" placeholder="votre@email.com">
                    </div>
                     <div class="form-group">
                        <label for="userPhoneSEOConsulting">Votre t√©l√©phone</label>
                        <input type="text" id="userPhoneSEOConsulting" placeholder="+212123456789">
                    </div>
                    <div class="form-buttons">
                        <button class="cancel-btn" id="cancelSEOConsulting">Annuler</button>
                        <button class="submit-btn" id="submitSEOConsulting">Envoyer</button>
                    </div>
                `;

      chatBody.appendChild(contactForm);

      // Add event listeners
      document
        .getElementById("cancelSEOConsulting")
        .addEventListener("click", function () {
          contactForm.remove();
        });

      document
        .getElementById("submitSEOConsulting")
        .addEventListener("click", async function () {
          const sector = document.getElementById("sectorSEOConsulting").value;
          const url = document.getElementById("urlSEOConsulting").value;
          const email = document.getElementById("userEmailSEOConsulting").value;
          const phone = document.getElementById("userPhoneSEOConsulting").value;

          if (!sector || !email) {
            alert("Veuillez remplir tous les champs obligatoires.");
            return;
          }

          try {
            // Prepare email template parameters
            const templateParams = {
              message: `Bonjour, je souhaite un devis pour le service de Conseil SEO:
        Secteur: ${sector} \n
        Site web: ${url} \n
        Email: ${email} \n
        Telephone: ${phone}
       `,
              reply_to: email,
            };

            // Send email using EmailJS instead of localhost
            await emailjs.send(
              "service_8hmb2eq",
              "template_jmcu1f9",
              templateParams,
            );

            const whatsappUrl = `https://wa.me/212671884968`;

            addMessage(
              `Notre √©quipe vous enverra une proposition sous 24h.<br><br>
            <strong>Vous pouvez √©galement parler directement avec un conseiller pour plus de d√©tails via WhatsApp :</strong><br>
            <a href="${whatsappUrl}" target="_blank" style="color: #0a0f4f; text-decoration: underline;">
                Cliquez ici pour d√©marrer la conversation
            </a>`,
              "ai",
            );

            // Remove form
            if (contactForm) {
              contactForm.remove();
            }
          } catch (error) {
            console.error("Error:", error);
            addMessage(
              "D√©sol√©, une erreur s'est produite lors de l'envoi de votre message. Veuillez r√©essayer.",
              "ai",
            );
          }
        });

      // Scroll to bottom
      chatBody.scrollTop = chatBody.scrollHeight;
    }

    function showAdvertisingStrategy() {
      const contactForm = document.createElement("div");
      contactForm.id = "AdvertisingStrategy";
      contactForm.classList.add("contact-form");

      addMessage(
        `Nous pouvons cr√©er pour vous une campagne cibl√©e pour :<br>
        ‚Ä¢ G√©n√©rer plus de clients<br>
        ‚Ä¢ Booster vos ventes en ligne<br>
        ‚Ä¢ Augmenter votre notori√©t√©<br><br>
        Pour pr√©parer un plan personnalis√©, j‚Äôai besoin de :`,
        "ai",
      );

      contactForm.innerHTML = `
    <h3>Demande de Devis</h3>
                    <div class="form-group">
                        <label for="sectorAdvertisingStrategy">Votre secteur d‚Äôactivit√©</label>
                        <input type="text" id="sectorAdvertisingStrategy" placeholder="Ex: Restauration, Immobilier, Sant√©...">
                    </div>
                    <div class="form-group">
                        <label for="objectivAdvertisingStrategy">Votre objectif principal</label>
                        <input type="text" id="objectivAdvertisingStrategy">
                    </div>
                    <div class="form-group">
                        <label for="userEmailAdvertisingStrategy">Votre email</label>
                        <input type="email" id="userEmailAdvertisingStrategy" placeholder="votre@email.com">
                    </div>
                     <div class="form-group">
                        <label for="userPhoneAdvertisingStrategy">Votre t√©l√©phone</label>
                        <input type="text" id="userPhoneAdvertisingStrategy" placeholder="+212123456789">
                    </div>
                    <div class="form-buttons">
                        <button class="cancel-btn" id="cancelAdvertisingStrategy">Annuler</button>
                        <button class="submit-btn" id="submitAdvertisingStrategy">Envoyer</button>
                    </div>
                `;

      chatBody.appendChild(contactForm);

      // Add event listeners
      document
        .getElementById("cancelAdvertisingStrategy")
        .addEventListener("click", function () {
          contactForm.remove();
        });

      document
        .getElementById("submitAdvertisingStrategy")
        .addEventListener("click", async function () {
          const sector = document.getElementById(
            "sectorAdvertisingStrategy",
          ).value;
          const objectiv = document.getElementById(
            "objectivAdvertisingStrategy",
          ).value;
          const email = document.getElementById(
            "userEmailAdvertisingStrategy",
          ).value;
          const phone = document.getElementById(
            "userPhoneAdvertisingStrategy",
          ).value;

          if (!sector || !email) {
            alert("Veuillez remplir tous les champs obligatoires.");
            return;
          }

          try {
            // Prepare email template parameters
            const templateParams = {
              message: `Bonjour, je souhaite un devis pour le service de strat√©gie publicitaire:
        Secteur: ${sector} \n
        L'objectif: ${objectiv} \n
        Email: ${email} \n
        Telephone: ${phone}
       `,
              reply_to: email,
            };

            // Send email using EmailJS instead of localhost
            await emailjs.send(
              "service_8hmb2eq",
              "template_jmcu1f9",
              templateParams,
            );

            const whatsappUrl = `https://wa.me/212671884968`;

            addMessage(
              `Notre √©quipe vous enverra une proposition sous 24h.<br><br>
            <strong>Vous pouvez √©galement parler directement avec un conseiller pour plus de d√©tails via WhatsApp :</strong><br>
            <a href="${whatsappUrl}" target="_blank" style="color: #0a0f4f; text-decoration: underline;">
                Cliquez ici pour d√©marrer la conversation
            </a>`,
              "ai",
            );

            // Remove form
            if (contactForm) {
              contactForm.remove();
            }
          } catch (error) {
            console.error("Error:", error);
            addMessage(
              "D√©sol√©, une erreur s'est produite lors de l'envoi de votre message. Veuillez r√©essayer.",
              "ai",
            );
          }
        });

      // Scroll to bottom
      chatBody.scrollTop = chatBody.scrollHeight;
    }

    function showQuoteForWebsite() {
      const contactForm = document.createElement("div");
      contactForm.id = "QuoteForWebsite";
      contactForm.classList.add("contact-form");

      addMessage(
        "Parfait ! Pour pr√©parer une estimation rapide, j‚Äôai besoin de :",
        "ai",
      );

      contactForm.innerHTML = `
    <h3>Demande de Devis</h3>
                    <div class="form-group">
                        <label for="sectorQuoteForWebsite">Votre secteur d‚Äôactivit√©</label>
                        <input type="text" id="sectorQuoteForWebsite" placeholder="Ex: Restauration, Immobilier, Sant√©...">

                    </div>
                    <div class="form-group">
                        <label>Le type de site souhait√©</label>
                        <div class="service-tags quote-for-website">
                                <div class="service-tag" data-service="vitrine">Vitrine</div>
                                <div class="service-tag" data-service="e-commerce">E-Commerce</div>
                                <div class="service-tag" data-service="r√©servation en ligne">R√©servation en ligne</div>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="userEmailQuoteForWebsite">Votre email</label>
                        <input type="email" id="userEmailQuoteForWebsite" placeholder="votre@email.com">
                    </div>
                     <div class="form-group">
                        <label for="userPhoneQuoteForWebsite">Votre t√©l√©phone</label>
                        <input type="text" id="userPhoneQuoteForWebsite" placeholder="+212123456789">
                    </div>
                    <div class="form-buttons">
                        <button class="cancel-btn" id="cancelQuoteForWebsite">Annuler</button>
                        <button class="submit-btn" id="submitQuoteForWebsite">Envoyer</button>
=======
                    <h3>Contactez un expert</h3>
                    <div class="form-group">
                        <label for="userQuestion">Votre question</label>
                        <textarea id="userQuestion" placeholder D√©crivez votre projet ou posez votre question..." rows="3"></textarea>
                    </div>
                    <div class="form-group">
                        <label>Service concern√©</label>
                        <div class="service-tags">
                            ${SERVICES.map(
                              (service) =>
                                `<div class="service-tag" data-service="${service}">${service}</div>`,
                            ).join("")}
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="userEmail">Votre email</label>
                        <input type="email" id="userEmail" placeholder="votre@email.com">
                    </div>
                    <div class="form-buttons">
                        <button class="cancel-btn" id="cancelContact">Annuler</button>
                        <button class="submit-btn" id="submitContact">Envoyer</button>
>>>>>>> d274e2fe77923c326ce7467eb275eed2f3e83cb1
                    </div>
                `;

      chatBody.appendChild(contactForm);

      // Add event listeners
      document
<<<<<<< HEAD
        .getElementById("cancelQuoteForWebsite")
=======
        .getElementById("cancelContact")
>>>>>>> d274e2fe77923c326ce7467eb275eed2f3e83cb1
        .addEventListener("click", function () {
          contactForm.remove();
        });

<<<<<<< HEAD
      // Add selection functionality to all service tags
      document
        .querySelectorAll("#QuoteForWebsite .service-tag")
        .forEach((tag) => {
          tag.addEventListener("click", function () {
            // Only allow one selection per group
            const parentGroup = this.closest(".form-group");
            parentGroup
              .querySelectorAll(".service-tag")
              .forEach((t) => t.classList.remove("selected"));
            this.classList.add("selected");
          });
        });

      document
        .getElementById("submitQuoteForWebsite")
        .addEventListener("click", async function () {
          const sector = document.getElementById("sectorQuoteForWebsite").value;
          const service =
            document.querySelector("#QuoteForWebsite [data-service].selected")
              ?.dataset.service || "Non sp√©cifi√©";
          const email = document.getElementById(
            "userEmailQuoteForWebsite",
          ).value;
          const phone = document.getElementById(
            "userPhoneQuoteForWebsite",
          ).value;

          if (!sector || !email) {
=======
      document.querySelectorAll(".service-tag").forEach((tag) => {
        tag.addEventListener("click", function () {
          document
            .querySelectorAll(".service-tag")
            .forEach((t) => t.classList.remove("selected"));
          this.classList.add("selected");
        });
      });

      document
        .getElementById("submitContact")
        .addEventListener("click", async function () {
          const question = document.getElementById("userQuestion").value;
          const service =
            document.querySelector(".service-tag.selected")?.dataset.service ||
            "Non sp√©cifi√©";
          const email = document.getElementById("userEmail").value;

          if (!question || !email) {
>>>>>>> d274e2fe77923c326ce7467eb275eed2f3e83cb1
            alert("Veuillez remplir tous les champs obligatoires.");
            return;
          }

          try {
            // Prepare email template parameters
            const templateParams = {
<<<<<<< HEAD
              message: `Bonjour, je souhaite un devis pour le service de cr√©ation de site web:
        Secteur: ${sector} \n
        Le type de site: ${service} \n
        Email: ${email} \n
        Telephone: ${phone}
       `,
=======
              to_name: "Recipient Name",
              from_name: "Your Name",
              message: "question: " + question + "\n Service: " + service,
>>>>>>> d274e2fe77923c326ce7467eb275eed2f3e83cb1
              reply_to: email,
            };

            // Send email using EmailJS instead of localhost
            await emailjs.send(
              "service_8hmb2eq",
              "template_jmcu1f9",
              templateParams,
            );

            // Show confirmation with WhatsApp link
<<<<<<< HEAD
            // const whatsappMessage = encodeURIComponent(
            //   `Bonjour, j'ai une question concernant ${service} : ${question} (Email: ${email})`,
            // );
            const whatsappUrl = `https://wa.me/212671884968`;

            addMessage(
              `Notre √©quipe vous enverra une proposition sous 24h.<br><br>
            <strong>Vous pouvez √©galement parler directement avec un conseiller pour plus de d√©tails via WhatsApp :</strong><br>
            <a href="${whatsappUrl}" target="_blank" style="color: #0a0f4f; text-decoration: underline;">
                Cliquez ici pour d√©marrer la conversation
=======
            const whatsappMessage = encodeURIComponent(
              `Bonjour, j'ai une question concernant ${service} : ${question} (Email: ${email})`,
            );
            const whatsappUrl = `https://wa.me/212671884968?text=${whatsappMessage}`;

            addMessage(
              `Merci! Votre demande a √©t√© envoy√©e. Un expert Brosmedia vous contactera tr√®s bient√¥t.<br><br>
            <strong>Contactez-nous directement sur WhatsApp :</strong><br>
            <a href="${whatsappUrl}" target="_blank" style="color: #0a0f4f; text-decoration: underline;">
                üëâ Cliquez ici pour discuter maintenant sur WhatsApp
>>>>>>> d274e2fe77923c326ce7467eb275eed2f3e83cb1
            </a>`,
              "ai",
            );

            // Remove form
            if (contactForm) {
              contactForm.remove();
            }
          } catch (error) {
            console.error("Error:", error);
            addMessage(
              "D√©sol√©, une erreur s'est produite lors de l'envoi de votre message. Veuillez r√©essayer.",
              "ai",
            );
          }
        });

      // Scroll to bottom
      chatBody.scrollTop = chatBody.scrollHeight;
    }

    // Quick replies
    const quickReplies = {
      default: [
        "D√©couvrir nos services",
        "Consulter nos tarifs",
        "Voir notre portfolio",
        "Parler √† un conseiller",
      ],
      Services: ["Sites web", "SEO", "Publicit√©", "Vid√©o & Photo"],
      Sites_web: ["Oui, je veux conna√Ætre les tarifs"],
      pricing: [
        "Oui, pr√©parez un devis",
        "Non, je veux d‚Äôabord voir vos services en publicit√©",
      ],
      Publicit√©: [
        "Attirer plus de clients rapidement",
        "Booster mes ventes en ligne",
        "Augmenter ma notori√©t√©",
      ],
<<<<<<< HEAD
      VideoPhoto: [
        "Vid√©o promotionnelle",
        "Photos produits",
        "Spot publicitaire",
        "Autre",
      ],
      packs: [
        "Oui, aidez-moi √† choisir",
        "Non, je pr√©f√®re demander un devis directement",
      ],
      portfolio: ["Oui, montrez-moi un exemple de mon domaine."],
      contact: [
        "Devis pour un site web",
        "Strat√©gie publicitaire",
        "Conseil SEO",
        "Autre demande",
        // "Contacter directement un conseiller humain",
      ],
      otherRequest: [
        "Envoyer ma demande et √™tre contact√©",
        "Parler directement √† un conseiller",
      ],
=======
>>>>>>> d274e2fe77923c326ce7467eb275eed2f3e83cb1
    };

    // Add quick replies
    function addQuickReplies(userMessage) {
      console.log(userMessage);
      let quickR = [];
      switch (userMessage) {
        case "Services":
          quickR = quickReplies.Services;
          break;

        case "Non, je veux d‚Äôabord voir vos services en publicit√©":
          quickR = quickReplies.Publicit√©;
          break;

<<<<<<< HEAD
        case "Publicit√©":
          quickR = quickReplies.Publicit√©;
          break;

=======
>>>>>>> d274e2fe77923c326ce7467eb275eed2f3e83cb1
        case "Sites web":
          quickR = quickReplies.Sites_web;
          break;

        case "Oui, je veux conna√Ætre les tarifs":
          quickR = quickReplies.pricing;
          break;

<<<<<<< HEAD
        case "Vid√©o & Photo":
          quickR = quickReplies.VideoPhoto;
          break;

        case "Tarifs":
          quickR = quickReplies.packs;
          break;

        case "Portfolio":
          quickR = quickReplies.portfolio;
          break;

        case "Contact":
          quickR = quickReplies.contact;
          break;

        case "Autre demande":
          quickR = quickReplies.otherRequest;
          break;

        default:
          quickR = [];
=======
        default:
          quickR = quickReplies.default;
>>>>>>> d274e2fe77923c326ce7467eb275eed2f3e83cb1
          break;
      }

      const quickReplyContainer = document.createElement("div");
      quickReplyContainer.classList.add("quick-replies");

      quickR.forEach((reply) => {
        const quickReply = document.createElement("div");
        quickReply.classList.add("quick-reply");
        quickReply.textContent = reply;
        quickReply.addEventListener("click", function () {
          addMessage(reply, "user");
          showTypingIndicator();
          setTimeout(() => {
            removeTypingIndicator();
            aiResponse(reply);
          }, 1500);
        });

        quickReplyContainer.appendChild(quickReply);
      });

      const lastMessage = chatBody.lastElementChild;
<<<<<<< HEAD

=======
>>>>>>> d274e2fe77923c326ce7467eb275eed2f3e83cb1
      lastMessage.appendChild(quickReplyContainer);

      // Scroll to bottom
      chatBody.scrollTop = chatBody.scrollHeight;
    }

    // Add event listeners for quick replies in the initial message
    document.querySelectorAll(".quick-reply").forEach((reply) => {
      reply.addEventListener("click", function () {
        const replyText = this.dataset.reply;
        addMessage(replyText, "user");
        showTypingIndicator();
        setTimeout(() => {
          removeTypingIndicator();
          aiResponse(replyText);
        }, 1000);
      });
    });
  });
</script>
