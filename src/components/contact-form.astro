<style>
    .form-check-input[type="radio"] {
        border: 2px solid #e30f29;
        width: 18px;
        height: 18px;
        margin-top: 0.3rem;
    }

    .form-check-input:checked {
        background-color: #e30f29;
        border-color: #e30f29;
    }

    .form-check {
        margin-right: 2rem;
    }
</style>

<div class="contact-form-wrapper">
    <h2 class="text-center mb-4">Contacter notre Agence</h2>
    <h3 class="text-center mb-4">
        Confiez-nous la création de votre site web sur-mesure et la gestion de
        votre stratégie digitale performante.
    </h3>

    <form id="contactForm" class="php-email-form">
        <div class="row g-3">
            Choisissez votre sujet:
            <div class="col-md-12">
                <div class="d-flex align-items-center">
                    <div class="form-check">
                        <input
                            class="form-check-input"
                            type="radio"
                            name="exampleRadios"
                            id="radio1"
                            data-val="Demande de devis"
                            checked
                        />
                        <label class="form-check-label" for="radio1">
                            Demande de devis
                        </label>
                    </div>
                    <div class="form-check">
                        <input
                            class="form-check-input"
                            type="radio"
                            name="exampleRadios"
                            id="radio2"
                            data-val="Demande de stage/emploi"
                        />
                        <label class="form-check-label" for="radio2">
                            Demande de stage/emploi
                        </label>
                    </div>
                    <div class="form-check">
                        <input
                            class="form-check-input"
                            type="radio"
                            name="exampleRadios"
                            id="radio3"
                            data-val="Autre"
                        />
                        <label class="form-check-label" for="radio3">
                            Autre
                        </label>
                    </div>
                </div>
            </div>
            <br />
            <br />
        </div>

        <div class="row g-3">
            <div class="col-md-6">
                <div class="form-group">
                    <div class="input-with-icon">
                        <i class="bi bi-person"></i>
                        <input
                            type="text"
                            class="form-control"
                            name="name"
                            placeholder="Nom"
                            required="Name"
                            id="contactUsName"
                        />
                    </div>
                </div>
            </div>

            <div class="col-md-6">
                <div class="form-group">
                    <div class="input-with-icon">
                        <i class="bi bi-envelope"></i>
                        <input
                            type="email"
                            class="form-control"
                            name="email"
                            placeholder="Adresse e-mail"
                            required=""
                            id="contactUsEmail"
                        />
                    </div>
                </div>
            </div>

            <div class="col-md-12">
                <div class="form-group">
                    <div class="input-with-icon">
                        <i class="bi bi-text-left"></i>
                        <input
                            type="text"
                            class="form-control"
                            name="subject"
                            placeholder="Sujet"
                            required=""
                            id="contactUsSubject"
                        />
                    </div>
                </div>
            </div>

            <div class="col-12">
                <div class="form-group">
                    <div class="input-with-icon">
                        <i class="bi bi-chat-dots message-icon"></i>
                        <textarea
                            class="form-control"
                            name="message"
                            placeholder="Écrire un message..."
                            style="height: 180px"
                            id="contactUsMsg"
                            required=""></textarea>
                    </div>
                </div>
            </div>

            <div class="row">
                <div class="col-md-9">
                    <div class="form-group" id="attachmentsSection">
                        <input
                            type="url"
                            name="attachments[]"
                            placeholder="Collez le lien de votre fichier"
                            class="attachment-input"
                        />
                        <small
                            >Vous pouvez ajouter plusieurs liens. Assurez-vous
                            que vos fichiers sont publics.</small
                        >
                    </div>
                </div>

                <div class="col-md-3">
                    <button type="button" class="addAttachmentBtn"
                        >+ Ajouter un autre lien</button
                    >
                </div>
            </div>

            <div class="col-12">
                <div class="loading">En cours</div>
                <div class="error-message"></div>
                <div class="sent-message">
                    Votre message a été envoyé. Merci !
                </div>
            </div>

            <div class="col-12 text-center">
                <button
                    type="submit"
                    id="contactFormSubmit"
                    class="contact-form-submit btn btn-primary btn-submit"
                    >ENVOYER</button
                >
            </div>
        </div>
    </form>

    <br />

    <p class="text-center">
        Les informations fournies via ce formulaire sont enregistrées dans un
        fichier informatisé pour la gestion de notre clientèle et de nos
        prospects. En le soumettant, vous acceptez l’utilisation de vos données
        dans le cadre de votre demande et de la relation commerciale qui
        pourrait en résulter. Pour plus d’informations sur vos droits, consultez
        notre <a
            href="/politiques-de-brosmedia"
            style="color :#e30f29"
            target="_blank">politique de confidentialité</a
        >.
    </p>
</div>

<script>
   document.addEventListener("DOMContentLoaded", function () {
  // Add dynamic attachment inputs for all forms
  document.querySelectorAll(".contactForm").forEach(form => {
    const addBtn = form.querySelector(".addAttachmentBtn");
    const attachmentsSection = form.querySelector(".attachmentsSection");

    addBtn.addEventListener("click", function () {
      const input = document.createElement("input");
      input.type = "url";
      input.name = "attachments[]";
      input.placeholder = "Collez le lien de votre fichier";
      input.classList.add("attachment-input");
      attachmentsSection.insertBefore(input, addBtn);
    });

    // Handle form submission
    form.querySelector(".contact-form-submit").addEventListener("click", async function (event) {
      event.preventDefault();

      // Show loading
      form.querySelector(".loading").style.display = "block";
      form.querySelector(".error-message").style.display = "none";
      form.querySelector(".sent-message").style.display = "none";

      // Get form values
      const name = form.querySelector('input[name="name"]').value || "";
      const email = form.querySelector('input[name="email"]').value || "";
      const subject = form.querySelector('input[name="subject"]').value || "";
      const message = form.querySelector('textarea[name="message"]').value || "";

      // Collect all attachment URLs
      const attachments = Array.from(form.querySelectorAll(".attachment-input"))
        .map(input => input.value)
        .filter(url => url.trim() !== "");

      try {
        const templateParams = {
          message: `
Nom: ${name}
Email: ${email}
Sujet: ${subject}
Message: ${message}
Pièces jointes: ${attachments.join("\n")}
          `,
          reply_to: email,
          from_name: name,
          to_name: "Vidéo & Photo Service",
          subject: subject,
        };

        // Send email via EmailJS
        await emailjs.send("service_8hmb2eq", "template_jmcu1f9", templateParams);

        // Show success
        form.querySelector(".loading").style.display = "none";
        form.querySelector(".sent-message").style.display = "block";
        form.reset();
      } catch (error) {
        console.error("Erreur d'envoi :", error);
        form.querySelector(".loading").style.display = "none";
        form.querySelector(".error-message").style.display = "block";
        form.querySelector(".error-message").textContent =
          "Une erreur s'est produite lors de l'envoi du message. Veuillez réessayer.";
      }
    });
  });
});

</script>
